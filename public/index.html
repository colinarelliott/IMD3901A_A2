<!DOCTYPE html>
<!--
METADATA
Author: Colin Elliott
Date: 2021-03-01
Class: IMD 3901
Description: Assignment 2
Assets: self-made
Sounds: from Epidemic Sound license
-->
<html>
    <head>
        <!--A-frame and environment scripts-->
        <script src="https://aframe.io/releases/1.4.1/aframe.min.js"></script> <!--A-Frame basic script-->
        <script src="https://unpkg.com/aframe-environment-component@1.3.2/dist/aframe-environment-component.min.js"></script> <!--Environment script-->
        <!--Custom components-->
        <script src="/js/laser-swap.js"></script>
        <script src="/js/pickup-gun.js"></script>
        <script src="/js/shoot-gun.js"></script>
        <script src="/js/collision-check.js"></script>
        <script src="/js/game-manager.js"></script>
    </head>
    <body>
        <a-scene id="scene">
            <a-entity 
                id="game-manager" 
                game-manager="gameOn: false;"
            >
            </a-entity>
            <!--Load assets-->
            <a-assets timeout="3000"> <!--timeout=3000 by default, modify if loading large assets-->
                <a-asset-item id="gun_model" src="/assets/lowPolyGun.glb" response-type="arraybuffer"></a-asset-item>
                <a-asset-item id="target" src="/assets/target.glb" response-type="arraybuffer"></a-asset-item>
                <audio id="gunshot" src="/assets/gunshot.mp3" preload="auto" volume="0.5"></audio>
                <audio id="gunshot-hit" src="/assets/gunshot_hit.mp3" preload="auto" volume="0.5"></audio>
            </a-assets>

            <!--Camera & controls-->
            <a-entity id="camera" camera wasd-controls look-controls position="0 1.6 0" collision-check>
                <a-entity
                    id="mouse-raycaster"
                    cursor="rayOrigin:mouse;"
                    raycaster="far:20; interval: 100; objects: .interactable;"> <!--only cast 20m, every 200ms, only look for objects with class 'interactable'-->
                </a-entity>
                <a-entity
                    id="score-display"
                    text="value: pickup the gun; color: white; align: center; width: 2;"
                    position="0 0.5 -1"
                ></a-entity>
            </a-entity>
            <a-entity id="otc-left" oculus-touch-controls="hand: left"></a-entity>
            <a-entity id="otc-right" oculus-touch-controls="hand: right"></a-entity>
            <a-entity id="player-laser-wrapper" collision-check>
                <a-entity 
                    id="laser" 
                    laser-controls="hand: right" 
                    raycaster="lineColor: white; lineOpacity: 0.5; objects: .interactable; far:20; interval: 100; " 
                    laser-swap>
                </a-entity>
            </a-entity>

            <!--Objects-->
            <a-entity 
                id="gun"
                class="interactable"
                pickup-gun
                gltf-model="#gun_model"
                position="0.5 0.75 -2"
                scale="0.1 0.1 0.1"
                rotation="90 230 0"
                shadow
                animation__enter="
                    startEvents: mouseenter;
                    property: scale;
                    to: 0.12 0.12 0.12;
                    dur: 1000;
                "
                animation__leave="
                    startEvents: mouseleave;
                    property: scale;
                    to: 0.1 0.1 0.1;
                    dur: 1000;
                "
                sound = "src: #gunshot; poolSize: 20;"
                
            ></a-entity>
            <a-entity
                id="hit-sound"
                sound = "src: #gunshot-hit; poolSize: 20;"
            >
            </a-entity>
            <a-entity 
                id="target"
                class="shootMe"
                gltf-model="#target"
                position="0 2 -5"
                scale="0.5 0.5 0.5"
                rotation="0 180 0"
                shadow
            ></a-entity>
            <a-entity
                id="bench"
                geometry="primitive:box"
                position="0 0.25 -2"
                scale="3 1 1"
                material="color: brown;"
                shadow
            ></a-entity>

            <!--Environment-->
            <a-entity id="env" environment="preset: forest" shadow></a-entity> 

            <!--Lighting-->
            <a-entity 
                id="sunlight"
                position="5 1 5"
                light="
                    color: #EEE;
                    castShadow: true; 
                    shadowBias:0.001;
                    intensity:1.5;
                "
            ></a-entity>
        </a-scene>
    </body>
</html>